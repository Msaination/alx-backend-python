#!/bin/bash

# kubctl-0x02.sh
# Objective: Deploy blue and green versions, check logs for errors.

echo "ğŸš€ Deploying BLUE version..."
kubectl apply -f blue_deployment.yaml

echo "ğŸš€ Deploying GREEN version..."
kubectl apply -f green_deployment.yaml

echo "ğŸ” Applying service..."
kubectl apply -f kubeservice.yaml

echo "ğŸ“‹ Current pods:"
kubectl get pods -l app=messaging-app

echo "âš¡ Checking logs for GREEN pods..."
GREEN_PODS=$(kubectl get pods -l app=messaging-app,version=green -o jsonpath='{.items[*].metadata.name}')
for pod in $GREEN_PODS; do
  echo "Logs for $pod:"
  kubectl logs $pod | tail -n 20
done
